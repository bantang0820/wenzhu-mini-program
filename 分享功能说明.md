# 共鸣分享卡功能说明

## 📱 功能概述

用户完成呼吸练习后，可以分享共鸣卡片给朋友，分享成功后解锁"吃饭慢"场景。

---

## 🎴 3个共鸣分享卡

### 1. 写作业场景卡片
- **触发场景**：用户完成"写作业拖拉"场景的呼吸练习
- **标题**：又要因为作业发火了
- **配色**：莫兰迪红灰 #E8DFDF
- **解锁**：吃饭慢场景

### 2. 孩子磨蹭场景卡片
- **触发场景**：用户完成"孩子磨蹭"场景的呼吸练习
- **标题**：早上又迟到了
- **配色**：莫兰迪蓝灰 #DFE8E8
- **解锁**：吃饭慢场景

### 3. 顶嘴场景卡片
- **触发场景**：用户完成"顶嘴"场景的呼吸练习
- **标题**：被孩子顶撞了
- **配色**：莫兰迪绿灰 #E8F0E0
- **解锁**：吃饭慢场景

---

## 🔄 用户流程

```
完成呼吸练习
  ↓
显示3个按钮
  ├─ 呼叫队友
  ├─ 分享给朋友 ← 新功能
  └─ 返回首页
  ↓
点击"分享给朋友"
  ↓
进入分享页面
  - 显示卡片预览
  - 提示解锁奖励
  ↓
点击"分享给朋友"或"分享到朋友圈"
  ↓
触发微信分享
  ↓
分享成功（宽松策略）
  ↓
弹出解锁提示
  ↓
返回首页
  - "吃饭慢"场景已解锁
  - 锁定图标消失
```

---

## 💾 数据存储

### 本地存储
```javascript
// 存储已解锁的场景ID列表
wx.setStorageSync('unlockedScenarios', ['004'])

// 读取已解锁的场景
const unlocked = wx.getStorageSync('unlockedScenarios') || []
```

### 解锁判断
```javascript
// 判断场景是否已解锁
const isUnlocked = unlockedScenarios.includes('004')

// 在首页显示时移除锁定图标
wx:if="{{!item.is_free && !isPro && !unlockedScenarios.includes(item.id)}}"
```

---

## 🎨 卡片设计规范

### 尺寸
- **卡片尺寸**：750 x 1334 px（iPhone屏幕比例）
- **小程序码**：120 x 120 px，右下角

### 布局
```
┌────────────────────────┐
│   [插画区域 60%]        │
│   - Emoji装饰          │
│   - 占位提示文字        │
│   （后期替换为插画）    │
├────────────────────────┤
│   [文案区域 30%]        │
│   - 标题               │
│   - 正文（支持换行）    │
│   - 分隔线             │
│   - 小程序码           │
│   - 引导文字           │
└────────────────────────┘
```

### 色彩
- **背景**：根据场景动态变化
- **文字**：#3D3D3D（主）、#5A5A5A（副）
- **小程序码**：右下角，半透明融入

---

## 🖼️ 插画资源

### 当前方案：占位图
暂时使用文字占位，后期替换为插画。

### 推荐插画资源（版权友好）

#### 1. unDraw (undraw.co)
- 免费、可商用
- 扁平风格
- 可自定义配色

#### 2. Storyset (storyset.com)
- 免费动画插画
- 支持导出PNG/SVG
- 适合做动效

#### 3. Open Doodles
- 手绘风格
- CC0协议（无版权限制）

#### 4. Illustrations (illlustrations.co)
- 开源插画库
- MIT许可证
- 可商用

### 搜索关键词
```
- parenting / family
- study / homework
- clock / time
- conflict / conversation
- emotions / calm
```

---

## 🔧 技术实现

### 文件结构
```
utils/
  └── shareCards.js          # 分享卡片配置

pages/share/
  ├── share.wxml             # 分享页面
  ├── share.wxss             # 分享样式
  ├── share.js               # 分享逻辑
  └── share.json             # 页面配置
```

### 核心代码

#### 1. 获取分享卡片
```javascript
const shareCards = require('../../utils/shareCards.js');
const cardConfig = shareCards.getShareCardByScenarioId(scenarioId);
```

#### 2. 解锁场景
```javascript
// 添加到已解锁列表
unlockedScenarios.push(scenarioId);

// 保存到本地存储
wx.setStorageSync('unlockedScenarios', unlockedScenarios);

// 显示成功提示
wx.showModal({
  title: '🎉 恭喜！',
  content: '分享成功！已解锁"吃饭慢"场景'
});
```

#### 3. 首页判断解锁状态
```javascript
onShow() {
  // 每次显示页面时重新加载
  this.loadUnlockedScenarios();
}
```

---

## 📊 数据统计（可选）

### 分享行为追踪
```javascript
// 可以记录：
- 分享次数
- 分享场景
- 分享时间
- 分享方式（好友/朋友圈）

// 用于分析：
- 哪个场景最容易触发分享
- 用户的分享习惯
- 产品传播效果
```

---

## 🚀 后续优化

### Phase 2：Canvas绘制卡片
- 动态生成卡片图片
- 包含真实的插画
- 包含用户的使用数据
- 提升分享转化率

### Phase 3：个性化卡片
- 根据用户使用记录生成
- 显示"这是我第N次使用"
- 增加真实感和信任度

### Phase 4：A/B测试
- 测试不同文案的分享率
- 测试不同卡片的传播效果
- 优化解锁奖励机制

---

## 📝 注意事项

1. **版权问题**
   - 必须使用可商用的插画资源
   - 保留授权证明
   - 标注作者信息（如果需要）

2. **小程序码**
   - 需要在微信公众平台生成
   - 路径配置为：`/pages/index/index`
   - 保存在 `/images/qrcode.png`

3. **分享限制**
   - 微信对分享有频率限制
   - 避免过度引导分享
   - 遵守微信平台规范

4. **解锁逻辑**
   - 本地存储可被清除
   - 后期考虑云端存储
   - 防止用户通过清除缓存重复解锁

---

## 🎯 成功指标

### 分享率
- 分享按钮点击率
- 实际分享完成率

### 传播效果
- 通过分享进入的新用户数
- 新用户的留存率

### 解锁效果
- 分享后场景使用率
- "吃饭慢"场景的打开次数

---

**更新日期**：2025-01-15
**版本**：v2.1.0
